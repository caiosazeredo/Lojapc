{% extends "base.html" %}

{% block title %}Catálogo de PCs - PixelCraft PC{% endblock %}

{% block content %}
<section class="catalog-header">
    <div class="container">
        <h1>Nossos <span class="gradient-text">PCs</span></h1>
        <p>Máquinas únicas com arte e performance</p>
    </div>
</section>

<section class="catalog">
    <div class="container">
        <div class="catalog-content">
            <!-- Sidebar Filters -->
            <aside class="catalog-sidebar">
                <div class="filter-section">
                    <h3>Categorias</h3>
                    <div class="filter-options">
                        <a href="{{ url_for('catalog') }}" class="filter-option {% if not current_category %}active{% endif %}">
                            Todas
                        </a>
                        {% for category in categories %}
                        <a href="{{ url_for('catalog', category=category.slug) }}" 
                           class="filter-option {% if current_category == category.slug %}active{% endif %}"
                           style="--filter-color: {{ category.color }}">
                            <i class="fas fa-{{ category.icon }}"></i> {{ category.name }}
                        </a>
                        {% endfor %}
                    </div>
                </div>
                
                <div class="filter-section">
                    <h3>Faixa de Preço</h3>
                    <div class="price-range">
                        <input type="number" id="priceMin" placeholder="Min" value="{{ request.args.get('price_min', '') }}">
                        <span>-</span>
                        <input type="number" id="priceMax" placeholder="Max" value="{{ request.args.get('price_max', '') }}">
                    </div>
                    <button class="btn btn-sm btn-outline" onclick="applyFilters()">Aplicar</button>
                </div>
                
                <div class="filter-section">
                    <h3>Performance</h3>
                    <div class="filter-options">
                        <label class="checkbox-label">
                            <input type="checkbox" name="performance" value="5">
                            <span>Ultra ⚡⚡⚡⚡⚡</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="performance" value="4">
                            <span>Alta ⚡⚡⚡⚡</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="performance" value="3">
                            <span>Média ⚡⚡⚡</span>
                        </label>
                    </div>
                </div>
            </aside>
            
            <!-- Products Grid -->
            <div class="catalog-main">
                <div class="catalog-toolbar">
                    <div class="results-count">
                        {{ pcs|length }} PCs encontrados
                    </div>
                    <div class="sort-options">
                        <select onchange="sortProducts(this.value)">
                            <option value="newest">Mais recentes</option>
                            <option value="price_low">Menor preço</option>
                            <option value="price_high">Maior preço</option>
                            <option value="popular">Mais populares</option>
                        </select>
                    </div>
                </div>
                
                <div class="pc-grid">
                    {% for pc in pcs %}
                    <div class="pc-card" data-aos="fade-up">
                        {% if pc.limited_edition %}
                        <span class="badge badge-limited">Limited Edition</span>
                        {% elif pc.bestseller %}
                        <span class="badge badge-hot">Mais Vendido</span>
                        {% elif pc.pre_order %}
                        <span class="badge badge-pre">Pré-venda</span>
                        {% endif %}
                        
                        <div class="pc-image">
                            <img src="{{ pc.main_image or '/static/img/placeholder.jpg' }}" alt="{{ pc.name }}">
                            <div class="pc-overlay">
                                <a href="{{ url_for('product_detail', slug=pc.slug) }}" class="btn btn-white">
                                    <i class="fas fa-eye"></i> Ver Detalhes
                                </a>
                            </div>
                        </div>
                        
                        <div class="pc-info">
                            <span class="pc-category" style="color: {{ pc.category_color }}">
                                {{ pc.category_name }}
                            </span>
                            <h3 class="pc-name">{{ pc.name }}</h3>
                            <p class="pc-subtitle">{{ pc.subtitle }}</p>
                            
                            <div class="pc-specs">
                                {% if pc.processor %}
                                <span title="Processador"><i class="fas fa-microchip"></i> {{ pc.processor|truncate(30) }}</span>
                                {% endif %}
                                {% if pc.gpu %}
                                <span title="Placa de vídeo"><i class="fas fa-tv"></i> {{ pc.gpu|truncate(30) }}</span>
                                {% endif %}
                                {% if pc.ram %}
                                <span title="Memória RAM"><i class="fas fa-memory"></i> {{ pc.ram }}</span>
                                {% endif %}
                            </div>
                            
                            <div class="pc-footer">
                                <div class="pc-price">
                                    {% if pc.price_old %}
                                    <span class="price-old">R$ {{ pc.price_old|currency }}</span>
                                    {% endif %}
                                    <span class="price">R$ {{ pc.price|currency }}</span>
                                    <span class="price-installments">12x de R$ {{ (pc.price/12)|currency }}</span>
                                </div>
                                <button class="btn-add-cart" onclick="addToCart({{ pc.id }})">
                                    <i class="fas fa-shopping-cart"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                
                {% if not pcs %}
                <div class="empty-state">
                    <i class="fas fa-desktop"></i>
                    <h3>Nenhum PC encontrado</h3>
                    <p>Tente ajustar os filtros ou <a href="{{ url_for('catalog') }}">ver todos os PCs</a></p>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
function applyFilters() {
    const priceMin = document.getElementById('priceMin').value;
    const priceMax = document.getElementById('priceMax').value;
    let url = new URL(window.location.href);
    
    if (priceMin) url.searchParams.set('price_min', priceMin);
    else url.searchParams.delete('price_min');
    
    if (priceMax) url.searchParams.set('price_max', priceMax);
    else url.searchParams.delete('price_max');
    
    window.location.href = url.toString();
}

function sortProducts(sort) {
    let url = new URL(window.location.href);
    url.searchParams.set('sort', sort);
    window.location.href = url.toString();
}
</script>
{% endblock %}